<% provide(:title, t('vote.admin_votes')) %>
<div class="headline">
  <h1>
    <%= @vote_status.vote.title %>
    <small><%= vote_status_str(@vote_status.vote.status) %></small>
  </h1>
</div>

<div class="col-md-2 col-sm-12 vote margin">
  <span class="choices">
    <span class="title">
    <%= Vote.human_attribute_name(:choices) %> 
    </span>
    <span class="value">
      <%= fa_icon('hashtag') %> <%= @vote_status.vote.choices %>
    </span>
  </span>
  <hr>

  <span class="vote-count">
    <span class="title">
      <%= t('vote.number_of_votes') %>
    </span>

    <span class="value">
      <%= @vote_status.number_of_votes %>
    </span>
  </span>

  <span class="refresh">
    <%= link_to(refresh_count_admin_vote_path(@vote), remote: true, method: :post) do %>
      <%= fa_icon('refresh') %>
      <%= t(:update) %>
    <% end %>
  </span>
  <hr>
  <%= vote_state_link(@vote_status.vote, type: 'btn primary', route: :show) %>

  <% unless @vote_status.vote.open? %>
    <%= link_to(t('vote.edit_vote'), edit_admin_vote_path(@vote_status.vote),
                class: 'btn secondary') %>
    <%= link_to(t('vote.reset'), reset_admin_vote_path(@vote_status.vote),
                method: :patch,
                class: 'btn danger',
                data: { confirm: t('vote.confirm_reset') }) %>
  <% end %>

  <%= link_to(t('vote.admin_votes'), admin_votes_path,
                                     class: 'btn secondary') %>
</div>

<div class="col-md-10 col-sm-12 vote margin">

  <% if !@vote_status.vote.closed? %>
    <i><%= t('vote.still_open') %></i>
    <ul class="list">
      <% @vote_status.vote.vote_options.with_deleted.each do |v| %>
        <li><b><%= vote_option_str(v) %></b></li>
      <% end %>
    </ul>
  <% else %>
    <div class="headline">
      <h2><%= t('vote.results') %></h2>
    </div>
    <table class="table">
      <% @vote_status.vote.vote_options.order_all.each do |v| %>
        <tr>
          <td><b><%= vote_option_str(v) %></b></td>
          <td><b><%= v.count %></b></td>
        </tr>
      <% end %>
      <tr>
        <td><i><%= t('vote.sum_votes_blank') %></i></td>
        <td><i><%= vote_stats(@vote_status.vote) %></i></td>
      </tr>
    </table>
  <% end %>
  <hr>
</div>


<div class="col-md-12 col-sm-12">
  <div class="headline">
    <h2><%= t('vote.status') %></h2>
  </div>

  <div class="vote status" id="vote-status">
    <%= render '/admin/votes/status', vote_status_view: @vote_status %>
  </div>
</div>

<div class="col-md-12 col-sm-12">
  <div class="headline">
    <h2><%= models_name(Audit) %></h2>
  </div>

  <%= render '/admin/votes/audits', audit_grid: @audit_grid %>
</div>
